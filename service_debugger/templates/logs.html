<!DOCTYPE html>
<html>
<head>
    <title>Service Logs Viewer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; }
        .log-entry {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
        }
        .log-info { background-color: #e3f2fd; }
        .log-warning { background-color: #fff3cd; }
        .log-error { background-color: #f8d7da; }
        .log-debug { background-color: #f1f1f1; }
        .log-timestamp { font-size: 0.8em; color: #666; }
        .filters { margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">Service Logs Viewer</h1>
        
        <div class="filters">
            <h4>Filters</h4>
            <form method="GET" class="row g-3">
                <div class="col-md-3">
                    <label for="service" class="form-label">Service</label>
                    <select class="form-select" id="service" name="service">
                        <option value="">All Services</option>
                        <option value="gateway" {% if request.args.get('service') == 'gateway' %}selected{% endif %}>Gateway</option>
                        <option value="contact" {% if request.args.get('service') == 'contact' %}selected{% endif %}>Contacts</option>
                        <option value="transform" {% if request.args.get('service') == 'transform' %}selected{% endif %}>Transformer</option>
                        <option value="mapping" {% if request.args.get('service') == 'mapping' %}selected{% endif %}>Mapping</option>
                        <option value="mock-api" {% if request.args.get('service') == 'mock-api' %}selected{% endif %}>Mock API</option>
                        <option value="connect" {% if request.args.get('service') == 'connect' %}selected{% endif %}>Connect</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="level" class="form-label">Log Level</label>
                    <select class="form-select" id="level" name="level">
                        <option value="">All Levels</option>
                        <option value="debug" {% if request.args.get('level') == 'debug' %}selected{% endif %}>Debug</option>
                        <option value="info" {% if request.args.get('level') == 'info' %}selected{% endif %}>Info</option>
                        <option value="warning" {% if request.args.get('level') == 'warning' %}selected{% endif %}>Warning</option>
                        <option value="error" {% if request.args.get('level') == 'error' %}selected{% endif %}>Error</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label for="limit" class="form-label">Limit</label>
                    <select class="form-select" id="limit" name="limit">
                        <option value="50" {% if request.args.get('limit') == '50' %}selected{% endif %}>50</option>
                        <option value="100" {% if request.args.get('limit', '100') == '100' %}selected{% endif %}>100</option>
                        <option value="200" {% if request.args.get('limit') == '200' %}selected{% endif %}>200</option>
                        <option value="500" {% if request.args.get('limit') == '500' %}selected{% endif %}>500</option>
                    </select>
                </div>
                <div class="col-md-3 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100">Apply Filters</button>
                </div>
            </form>
        </div>
        
        <div id="logs">
            {% for log in logs %}
            <div class="log-entry log-{{ log.level }}">
                <div class="d-flex justify-content-between">
                    <strong>{{ log.service|upper }}</strong>
                    <span class="log-timestamp">{{ log.timestamp_formatted }}</span>
                </div>
                <div class="mt-1">
                    <span class="badge bg-{{ log.level_color }}">{{ log.level|upper }}</span>
                    {{ log.message }}
                </div>
                {% if log.data %}
                <div class="mt-2">
                    <pre class="bg-light p-2 rounded"><code>{{ log.data }}</code></pre>
                </div>
                {% endif %}
            </div>
            {% endfor %}

            {% if not logs %}
            <div class="alert alert-info">No logs found matching your filters.</div>
            {% endif %}
        </div>
        
        <div class="mt-4 text-center">
            <p class="text-muted">Auto-refreshing every 10 seconds</p>
            <button class="btn btn-secondary" onclick="location.reload()">Refresh Now</button>
        </div>
    </div>

    <script>
        // Auto-refresh logs every 10 seconds
        setTimeout(function() {
            location.reload();
        }, 10000);
    </script>
</body>
</html>